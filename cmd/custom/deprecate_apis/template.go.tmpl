<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Deprecated API(s) Dashboard</title>

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.24/datatables.min.css"/>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">


    <style>
        div.dataTables_wrapper {
            width: 98%;
            margin: 0 auto;
        }

        .themed-container {
            padding: .75rem;
            margin-bottom: 1.5rem;
            background-color: #F0F0F0;
            border: 1px solid #0D0C0C;
        }
    </style>


</head>
<body class="py-4">

<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.24/datatables.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

<script >

    $(document).ready(function() {
        $('#migrate').DataTable( {
            "scrollX": true
        } );
        $('#mechanism').DataTable( {
            "scrollX": true
        } );
        $('#ok').DataTable( {
            "scrollX": true
        } );
    } );

</script>

<main>

        <h1>Deprecated API(s) Dashboard</h1>
        <p>Following the packages and its finding(s) obtained by checking the image and the bundle manifests distributed. This report aims to try to identify the packages distributions that can impact the users on 4.9.</p>

        <div class="container-fluid themed-container">
            <h4 class="display-12 fw-bold">Data from the image used</h4>
            <ul>
                <li>Image name: {{ .ImageName }} </li>
                <li>Image ID: {{ .ImageID }} </li>
                <li>Created: {{ .ImageBuild }} </li>
            </ul>
        </div>

        <div class="container-fluid themed-container">
            <h4 class="display-12 fw-bold">FAQ</h4>
            <h4 class="display-12 fw-bold">1. Can my package has bundles using deprecated API(s) not found by this check?</h4>
            <p>Yes. The check can only be made by looking at the manifests shipped on the bundle. In this way, your operator might be using the deprecated/removed API(s) but not shipping its manifests on the bundle or has as dependency another operator that is using them.</p>
<h4 class="display-12 fw-bold">2. What action(s) should I take?</h4>
            <ul>
                <li>Check <a href="https://kubernetes.io/docs/reference/using-api/deprecation-guide/#v1-22"> Deprecated API Migration Guide (v1.22)</a> and ensure that your projects have them migrated and are not using any deprecated/removed API(s) </li>
                <li>Ensure that any distribution which requires be made with any deprecation API(s) to the OCP catalogs will be configured with the Max OpenShift Version compatible (`olm.openShiftMaxVersion`) and to be distributed only on OCP version(s) <= 4.8 via the annotation/label `com.redhat.openshift.versions`. More info see: <a href="https://github.com/operator-framework/community-operators/blob/master/docs/packaging-required-criteria-ocp.md"> OKD/OpenShift Catalogs criteria and options </a></li>
                <li>OpenShift 4.8 introduces two new alerts that fire when an API that will be removed in the next release is in use. Check the event alerts of your Operators running on 4.8 and ensure that you will not find any warning about these API(s) still being used by it</li>
            </ul>
</div>

        <div class="container-fluid themed-container">
            <h4 class="display-12 fw-bold">Not complying with the recommendations</h4>
            <p>All packages that have deprecated/removed API(s) and without any recommendation in place.</p>
            <table id="migrate" style="background-color: #EC1C1C; width:100%">
                <thead>
                <tr>
                    <th>Package Name</th>
                    <th>Kinds to migrate found from the API(s):</th>
                    <th>Bundles found using the API(s)</th>
                </tr>
                </thead>
                <tbody>
                {{ with .Migrate }}
                    {{ range . }}
                        <tr>
                             <th>{{ .Name }}</th>
                             <th>
                                 <ul>
                                    {{ range .Kinds }}
                                        <li>{{ . }}</li>
                                    {{ end }}
                                 </ul>
                             </th>
                             <th>
                                  <ul>
                                     {{ range .Bundles }}
                                         <li>{{ . }}</li>
                                     {{ end }}
                                  </ul>
                             </th>
                        </tr>
                    {{ end }}
                {{ end }}
                </tbody>
            </table>
        </div>

        <div class="container-fluid themed-container">
            <h4 class="display-12 fw-bold">Partially complying with the recommendations</h4>
<p>Packages which has at minimal one bundle following partially the recommendations</p>
            <ul>
                <li>not let them to be carried on to 4.9 (OCP Label). If set then, you will find (label:YES). </li>
                <li>AND/OR</li>
                <li>blocking the cluster upgrade with the Max OCP Version annotation. If set then, you will find (max:YES).</li>
                <li>AND/OR</li>
                <li>one bundle which seems that is no longer using the deprecated/removed API(s), and in this one migrated</li>
            </ul>
            <table id="mechanism" style="background-color: #ec8f1c; width:100%">
                <thead>
                <tr>
                    <th>Package Name</th>
                    <th>Kinds to migrate found from the API(s):</th>
                    <th>Bundles found using the API(s)</th>
                    <th>Bundles Migrated</th>
                </tr>
                </thead>
                <tbody>
                {{ with .Suggestion }}
                    {{ range . }}
                        <tr>
                            <th>{{ .Name }}</th>
                            <th>
                                <ul>
                                {{ range .Kinds }}
                                    <li>{{ . }}</li>
                                {{ end }}
                                </ul>
                            </th>
                            <th>
                              <ul>
                                 {{ range .Bundles }}
                                     <li>{{ . }}</li>
                                 {{ end }}
                              </ul>
                            </th>
                            <th>
                              <ul>
                                 {{ range .BundlesMigrated }}
                                     <li>{{ . }}</li>
                                 {{ end }}
                              </ul>
                            </th>
                        </tr>
                    {{ end }}
                {{ end }}
                </tbody>
            </table>
        </div>

        <div class="container-fluid themed-container">
            <h4 class="display-12 fw-bold">Fully complying with the recommendations</h4>
            <p>Packages that were not possible to find in any bundle checked a manifest using the deprecated/removed API(s) or, when found, is complying fully with the recommendations.</p>
            <table id="ok" style="background-color:#3FA91E;width:100%">
                <thead>
                <tr>
                    <th>Package Name</th>
                </tr>
                </thead>
                <tbody>
                 {{ with .OK }}
                    {{ range . }}
                        <tr>
                            <th>{{ .Name }}</th>
                        </tr>
                    {{ end }}
                {{ end }}
                </tbody>
            </table>
        </div>
</main>

</body>
</html>
